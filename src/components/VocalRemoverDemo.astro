---
import { STEMS_CONFIG, ANIMATION_DELAYS } from './VocalRemoverDemo/constants';
import vocalImg from '../assets/voice/vocal.webp';
import drumsImg from '../assets/voice/drums.webp';
import bassImg from '../assets/voice/bass.webp';
import pianoImg from '../assets/voice/piano.webp';
import guitarImg from '../assets/voice/guitar.webp';
import otherImg from '../assets/voice/other.webp';

// Componentes
import ProgressBar from './VocalRemoverDemo/ProgressBar.astro';
import ControlButtons from './VocalRemoverDemo/ControlButtons.astro';
import StemRow from './VocalRemoverDemo/StemRow.astro';

// Mapa de im√°genes de espectro
const spectrumMap: Record<string, any> = {
  vocals: vocalImg,
  drums: drumsImg,
  bass: bassImg,
  piano: pianoImg,
  guitar: guitarImg,
  other: otherImg,
};
---

<style>
  .section-container {
    background: rgba(0, 0, 0, 0.15);
    border: 1px solid rgba(71, 85, 101, 0.3);
    border-radius: 1rem;
    padding: 1.5rem;
  }

  .music-player {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    margin-bottom: 1.5rem;
  }

  .player-info {
    display: flex;
    gap: 1.5rem;
    align-items: flex-start;
    justify-content: space-between;
  }

  .song-info {
    flex: 1;
  }

  .song-title {
    font-size: 1rem;
    font-weight: 600;
    color: white;
    margin-bottom: 0.75rem;
  }

  .stems-grid {
    display: grid;
    auto-rows: auto;
    gap: 0.25rem;
  }
</style>

<section class="section-container">
  <h2 class="text-3xl font-normal text-white pb-8 tracking-tighter">
    Apps de Inteligencia Artificial
  </h2>

  <!-- Audio Elements (hidden) -->
  {STEMS_CONFIG.map((stem) => (
    <audio id={`audio-${stem.id}`} preload="auto">
      <source src={stem.file} type="audio/wav" />
    </audio>
  ))}

  <!-- Music Player -->
  <div class="music-player">
    <div class="player-info">
      <div class="song-info">
        <p class="song-title">Billie Eilish - Bad Guy</p>
        <ProgressBar />
      </div>
      <ControlButtons />
    </div>
  </div>

  <!-- Stems Grid -->
  <div class="stems-grid">
    {STEMS_CONFIG.map((stem, index) => (
      <StemRow
        name={stem.name}
        id={stem.id}
        spectrum={spectrumMap[stem.id].src}
        animationDelay={ANIMATION_DELAYS[index]}
      />
    ))}
  </div>
</section>

<script>
  import './VocalRemoverDemo/index.ts';
</script>
